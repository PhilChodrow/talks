---
title: "Generative Hypergraph Clustering: <br> From Blockmodels to Modularity\n"
subtitle: ""
author: "Phil Chodrow (UCLA) <br> Nate Veldt (Cornell) <br> Austin Benson (Cornell)"
date: ""
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["style/css/DJN_xaringan_theme.css", "style/css/DJN_style.css",  "style/css/pc_custom_style.css"]
    seal: true
    nature:
      ratio: '3:2'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: ["style/js/macros.js"]
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>
---

```{r child = "style/rmd/DJN_setup.Rmd"}
```

---

layout: true

background-size: contain

---

## Team


.pull-left-third[.pink-bg[
.centered-image[![:scale 100%](img/nate.jpg)]
.embolden[Nate]  .embolden[Veldt]
.small[
  Math @ Cornell
  
  
  [Website](https://people.cam.cornell.edu/lnv22/)
  
  
  [@n_veldt](https://twitter.com/n_veldt)
]]]

.pull-left-third[.yellow-bg[
.centered-image[![:scale 100%](img/austin.jpg)]
.embolden[Austin]  .embolden[Benson]
.small[
  CS @ Cornell
  
  [cs.cornell.edu/~arb/](https://www.cs.cornell.edu/~arb/)

  [@austinbenson](https://twitter.com/austinbenson)
]]]


.pull-left-third[.blue-bg[
.centered-image[![:scale 100%](img/phil.jpg)]
.embolden[Phil]  .embolden[Chodrow]
.small[
  Math @ UCLA
  
  [philchodrow.com](https://www.philchodrow.com)

  [@philchodrow](https://twitter.com/PhilChodrow)
]]]


---

background-image: url(img/arxiv.png)

---

## Hypergraph Stochastic Blockmodel

.midi[
.pink-bg[
$$a_R \equiv \text{# of edges on tuple }R \sim \mathrm{Poisson}\left(\Omega(\mathbf{z}_R)\prod_{i \in R}\theta_i\right)$$
]]

- $\mathbf{z}$ is the vector of node labels (clusters).
- $\{\theta_i\}$ are *degree* parameters. 
- $\Omega$ is the *affinity function* that governs connections between different groups. 


.footnote[
Extends DCSBM of Karrer + Newman, "Stochastic blockmodels and community structure in networks." *PRE*, 2011

Bernoulli variant proposed by Ke et al., "Community detection for hypergraph networks via regularized tensor power iteration." *arxiv:*:1909.06503, 2019
]

---

## Symmetry Assumption

Assume that $\Omega$ is symmetric under permutations of node labels. 

Then, $\Omega(\mathbf{z}_R) = \Omega(\mathbf{p})$, where $\mathbf{p}$ is the partition of $\mathbf{z}_R$. 

Example: $\mathbf{z}_R = (1, 1, 1, 2, 3, 3)$, $\mathbf{p} = (3, 2, 1)$. 

Generalizes the *planted partition* assumption: all clusters statistically identical. 

---

## Approximate Inference

The maximum-likelihood estimates of $\{\theta_i\}$ and $\Omega$ are approximately
.pink-bg[
$$
\begin{aligned}
\hat{\theta}_i &\approx\text{degree of node }i \equiv d_i \\ 
\hat{\Omega}(\mathbf{p}) &\approx \frac{\text{# of hyperedges with partition } \mathbf{p}}{\sum_{\mathbf{y}: \mathbf{p}(\mathbf{y}) = \mathbf{p}}\prod_{y \in \mathbf{y}}y}\;.
\end{aligned}
$$ 
]

*These approximations are exact when all clusters have the same sum-of-degrees*. 

.footnote[
Zhang + Peixoto, "Statistical inference of assortative community structures." *PRR*, 2020]
---

## Approximate Log-Likelihood

.midi[
.pink-bg[
$$
\begin{aligned}
Q(\mathbf{z}, \Omega) &\equiv \sum_{\mathbf{p}}[ \Omega(\mathbf{p}) \textbf{cut}_\mathbf{p}(\mathbf{z}) +  \log \Omega(\mathbf{p}) \textbf{vol}_\mathbf{p}(\mathbf{z})] \\ 
&\approx \text{model log-likelihood} + \text{constants w.r.t.} \mathbf{z} 
\end{aligned}
$$
]]

$$
\begin{aligned}
  \textbf{cut}_\mathbf{p}(\mathbf{z}) &\equiv \text{# of hyperedges with partition } \mathbf{p}\\
  \textbf{vol}_\mathbf{p}(\mathbf{z}) &\equiv \sum_{\mathbf{y}: \mathbf{p}(y) = \mathbf{p}} \prod_{y \in \mathbf{y}} \textbf{vol}(y)
\end{aligned}
$$

We call $Q(\mathbf{z}, \Omega)$ a **symmetric hypergraph modularity.**

---

## All Or Nothing

Consider an edge of $k$ nodes. Suppose: 
$$\Omega(\mathbf{p}) = \begin{cases}
  \omega_{k1} &\quad \text{edge has homogeneous labels} \\ 
  \omega_{k0} &\quad \text{otherwise}\;.  
\end{cases}$$

Then, the **All-Or-Nothing hypergraph modularity** is 

.pink-bg[.midi[
$$
Q = \sum_k \beta_k \left[\text{# homogeneous }k\text{-edges} - \gamma_k\sum_j \textbf{vol}(j)^k\right]
$$
]]

.footnote[

Derivation follows Newman, "Equivalence between modularity optimization and maximum likelihood methods for community detection." *PRE*, 2016

Generalizes Kami≈Ñski et al., "Clustering via hypergraph modularity." *PLoS ONE*, 2019]

---

## Parsing Parameters

$$
Q = \sum_k \color{#0F4C81}{\beta_k} \left[\text{# homogeneous }k\text{-edges} - \color{#ec7a39}{\gamma_k}\sum_j \textbf{vol}(j)^k\right]
$$

$\color{#0F4C81}{\beta_k} \equiv \log \omega_{k1} - \log \omega_{k0}$. 
- .blue[Size parameters] control importance of edge sizes. 

$\color{#ec7a39}{\gamma_k} \equiv \frac{1}{\beta_k}(\omega_{k1} - \omega_{k0})$.
- .orange[Resolution parameters] control number of clusters

.embolden[Can be estimated!]


---

background-image: url(img/detectability.png)

# Detectability

---

background-image: url(img/contact-clustering.png)

---

background-image: url(img/contact-parameters.png)

---

background-image: url(img/performance.png)

---

background-image: url(img/recovery_experiments.png)




